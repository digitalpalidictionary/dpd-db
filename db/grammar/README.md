# db/grammar/

## Purpose & Rationale
The `grammar/` directory is responsible for the systematic mapping of inflected P캐拷을 word forms to their grammatical possibilities. Because a single P캐拷을 word can often represent multiple cases, numbers, or persons, this subsystem exists to provide users with a comprehensive breakdown of all potential grammatical roles for any given form found in the Tipitaka.

## Architectural Logic
This subsystem follows a "Grammatical Exhaustion" pattern:
1.  **Form Collection:** It identifies every unique inflected form generated by the `inflections/` module.
2.  **Possibility Mapping:** For each form, it references the dictionary data to determine its grammatical context (e.g., "Nominative Singular masculine" or "Aorist 3rd person plural").
3.  **Deduplication & Packing:** Multiple grammatical roles for the same form are combined and "packed" into a compact format suitable for the `Lookup` table.
4.  **Targeting:** It limits its scope to words actually present in the Tipitaka or deconstructions to keep the lookup table performant.

## Relationships & Data Flow
- **Input:** Utilizes the `DpdHeadword` data and `InflectionTemplates` from **db/models.py**.
- **Output:** Populates the `grammar` column in the `Lookup` table.
- **Application:** Power the "Grammar" button and search results in the **WebApp** and **GoldenDict** exports.

## Interface
- **Process:** `uv run python db/grammar/grammar_to_lookup.py`
